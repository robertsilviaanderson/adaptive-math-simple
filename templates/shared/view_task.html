<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ task.title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <h1>üìù {{ task.title }}</h1>
        
        <div style="text-align: center; margin-bottom: 30px;">
            <a href="{{ url_for('tasks.list_tasks') }}" class="btn">‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞–¥–∞–Ω–∏—è–º</a>
        </div>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
            <h3 style="color: #495057; margin-top: 0;">üìã –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:</h3>
            <p style="white-space: pre-wrap; line-height: 1.6;">{{ task.description }}</p>
        </div>
        
        <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin: 20px 0;">
            <p><strong>üìä –¢–µ–º–∞:</strong> {{ task.topic }}</p>
            <p><strong>‚≠ê –°–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> {{ task.difficulty_level }}/5</p>
            <p><strong>üéØ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª:</strong> {{ task.max_score }}</p>
            <p><strong>üìÖ –°–æ–∑–¥–∞–Ω–æ:</strong> {{ task.created_at.strftime('%d.%m.%Y %H:%M') }}</p>
        </div>
        
        {% if current_user.role == 'student' %}
            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #856404; margin-top: 0;">üìà –í–∞—à–∏ –ø–æ–ø—ã—Ç–∫–∏: {{ user_attempts|length }}</h3>
                {% if user_attempts %}
                    {% for attempt in user_attempts[:3] %}
                        <p><strong>–ü–æ–ø—ã—Ç–∫–∞ {{ loop.index }}:</strong> –ë–∞–ª–ª {{ attempt.partial_score }}/{{ task.max_score }} ({{ attempt.created_at.strftime("%d.%m.%Y %H:%M") }})</p>
                    {% endfor %}
                {% else %}
                    <p>–ü–æ–ø—ã—Ç–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                {% endif %}
            </div>
            
            <form method="POST" action="{{ url_for('tasks.solve_task', task_id=task.id) }}">
                <div style="background: white; padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid #3498db;">
                    <h3 style="color: #2c3e50; margin-top: 0;">‚úèÔ∏è –í–∞—à –æ—Ç–≤–µ—Ç:</h3>
                    <div class="form-group">
                        <textarea name="answer" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç –∑–¥–µ—Å—å..." style="width: 100%; height: 120px; padding: 15px; border: 2px solid #e1e8ed; border-radius: 8px; font-size: 16px; resize: vertical;" required></textarea>
                    </div>
                    <div style="text-align: center;">
                        <button type="submit" class="btn btn-success">üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </form>
        {% endif %}
    </div>
</body>
</html>
