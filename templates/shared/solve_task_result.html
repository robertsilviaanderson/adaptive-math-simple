<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ—à–µ–Ω–∏—è</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <div class="form-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ—à–µ–Ω–∏—è</div>
        
        <div class="{{ 'status' if is_correct else 'error' }}">
            {% if is_correct %}
                üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!
            {% else %}
                ‚ùå –û—Ç–≤–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!
            {% endif %}
        </div>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
            <h3 style="color: #495057; margin-top: 0;">üìù –í–∞—à –æ—Ç–≤–µ—Ç:</h3>
            <div style="background: white; padding: 15px; border-radius: 5px; border: 1px solid #dee2e6;">
                {% if attempt.user_answer.type == 'number' %}
                    <strong>–ß–∏—Å–ª–æ:</strong> {{ attempt.user_answer.value }}
                {% elif attempt.user_answer.type == 'variables' %}
                    <strong>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:</strong>
                    {% for var in attempt.user_answer.variables %}
                        {{ var.name }} = {{ var.value }}{% if not loop.last %}, {% endif %}
                    {% endfor %}
                {% elif attempt.user_answer.type == 'interval' %}
                    <strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª:</strong> 
                    {% if attempt.user_answer.start_inclusive %}[{% else %}({% endif %}{{ attempt.user_answer.start }}, {{ attempt.user_answer.end }}{% if attempt.user_answer.end_inclusive %}]{% else %}){% endif %}
                {% elif attempt.user_answer.type == 'sequence' %}
                    <strong>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> {{ attempt.user_answer.sequence_values|join(', ') }}
                {% else %}
                    {{ attempt.user_answer }}
                {% endif %}
            </div>
            
            <h3 style="color: #495057;">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
            <p><strong>–ë–∞–ª–ª:</strong> {{ score }}/{{ task.max_score }}</p>
            <p><strong>–ü–æ–ø—ã—Ç–∫–∞ ‚Ññ:</strong> {{ attempt.attempt_number }}</p>
            
            {% if not is_correct %}
                {% if task.explanation %}
                    <h3 style="color: #495057;">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞:</h3>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 5px; border: 1px solid #ffeaa7; margin-bottom: 15px;">
                        <p style="margin: 0; color: #856404;">{{ task.explanation }}</p>
                    </div>
                {% endif %}
                
                {% if correct_answer %}
                    <div style="text-align: center; margin: 15px 0;">
                        <button id="show-answer-btn" class="btn" style="background: #17a2b8; color: white;" onclick="showCorrectAnswer()">
                            üîç –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                        </button>
                    </div>
                    
                    <div id="correct-answer-section" style="display: none;">
                        <h3 style="color: #495057;">‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</h3>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 5px; border: 1px solid #c3e6c3;">
                            {% if correct_answer.type == 'number' %}
                                <strong>–ß–∏—Å–ª–æ:</strong> {{ correct_answer.value }}
                            {% elif correct_answer.type == 'variables' %}
                                <strong>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:</strong>
                                {% for var in correct_answer.variables %}
                                    {{ var.name }} = {{ var.value }}{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            {% elif correct_answer.type == 'interval' %}
                                <strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª:</strong> 
                                {% if correct_answer.start_inclusive %}[{% else %}({% endif %}{{ correct_answer.start }}, {{ correct_answer.end }}{% if correct_answer.end_inclusive %}]{% else %}){% endif %}
                            {% elif correct_answer.type == 'sequence' %}
                                <strong>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> {{ correct_answer.sequence_values|join(', ') }}
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        </div>
        
        <div style="text-align: center;">
            <a href="{{ url_for('tasks.view_task', task_id=task.id) }}" class="btn">üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑</a>
            <a href="{{ url_for('tasks.list_tasks') }}" class="btn btn-success">üìö –ö –¥—Ä—É–≥–∏–º –∑–∞–¥–∞–Ω–∏—è–º</a>
        </div>
    </div>
    
    <script>
        function showCorrectAnswer() {
            const button = document.getElementById('show-answer-btn');
            const answerSection = document.getElementById('correct-answer-section');
            
            if (answerSection.style.display === 'none') {
                answerSection.style.display = 'block';
                button.innerHTML = 'üôà –°–∫—Ä—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç';
                button.style.background = '#6c757d';
            } else {
                answerSection.style.display = 'none';
                button.innerHTML = 'üîç –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç';
                button.style.background = '#17a2b8';
            }
        }
    </script>
</body>
</html>
