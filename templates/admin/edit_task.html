{% extends "admin/base_admin.html" %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è #{{ task.id }}{% endblock %}

{% block content %}
<div class="admin-content">
    <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è #{{ task.id }}</h2>
    
    <div style="margin: 20px 0;">
        <a href="{{ url_for('admin.tasks') }}" class="btn">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –∑–∞–¥–∞–Ω–∏–π</a>
    </div>
    
    <form method="POST" class="task-form">
        <div class="form-group">
            <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</label>
            <input type="text" id="title" name="title" value="{{ task.title or '' }}" required>
        </div>
        
        <div class="form-group">
            <label for="description">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</label>
            <textarea id="description" name="description" rows="6" required>{{ task.description or '' }}</textarea>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="topic">–¢–µ–º–∞</label>
                <input type="text" id="topic" name="topic" value="{{ task.topic or '' }}" required>
            </div>
            
            <div class="form-group">
                <label for="difficulty_level">–°–ª–æ–∂–Ω–æ—Å—Ç—å (0.0 - 1.0)</label>
                <input type="number" id="difficulty_level" name="difficulty_level" 
                       min="0" max="1" step="0.1" 
                       value="{{ '%.1f'|format(task.difficulty_level) if task.difficulty_level is not none else '0.5' }}" 
                       required>
            </div>
            
            <div class="form-group">
                <label for="max_score">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª</label>
                <input type="number" id="max_score" name="max_score" 
                       min="0.1" step="0.1" 
                       value="{{ '%.1f'|format(task.max_score) if task.max_score is not none else '1.0' }}" 
                       required>
            </div>
        </div>
        
        <div class="form-group">
            <label>–¢–∏–ø –æ—Ç–≤–µ—Ç–∞</label>
            <div class="radio-group">
                <label class="radio-label">
                    <input type="radio" name="answer_type" value="text" 
                           {% if task.answer_type == 'text' or not task.answer_type %}checked{% endif %}>
                    –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç
                </label>
                <label class="radio-label">
                    <input type="radio" name="answer_type" value="number"
                           {% if task.answer_type == 'number' %}checked{% endif %}>
                    –ß–∏—Å–ª–æ–≤–æ–π –æ—Ç–≤–µ—Ç
                </label>
            </div>
        </div>
        
        <div class="form-group" id="text-answer-group" 
             style="{% if task.answer_type == 'number' %}display: none;{% endif %}">
            <label for="correct_answer">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</label>
            <input type="text" id="correct_answer" name="correct_answer" 
                   value="{% if task.correct_answer %}{{ task.correct_answer.value or task.correct_answer.answer or '' }}{% endif %}">
        </div>
        
        <div class="form-group" id="number-answer-group" 
             style="{% if task.answer_type != 'number' %}display: none;{% endif %}">
            <label for="correct_number">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (—á–∏—Å–ª–æ)</label>
            <input type="number" id="correct_number" name="correct_number" step="any"
                   value="{% if task.correct_answer %}{{ task.correct_answer.value or task.correct_answer.answer or '0' }}{% endif %}">
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            <a href="{{ url_for('admin.tasks') }}" class="btn">‚ùå –û—Ç–º–µ–Ω–∞</a>
        </div>
    </form>
</div>

<script>
// –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –æ—Ç–≤–µ—Ç–∞
document.querySelectorAll('input[name="answer_type"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const isNumber = this.value === 'number';
        document.getElementById('text-answer-group').style.display = isNumber ? 'none' : 'block';
        document.getElementById('number-answer-group').style.display = isNumber ? 'block' : 'none';
    });
});
</script>

<style>
.task-form {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.form-group {
    margin-bottom: 20px;
}

.form-row {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
}

.form-row .form-group {
    flex: 1;
    min-width: 200px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #333;
}

input[type="text"],
input[type="number"],
textarea {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    transition: border-color 0.2s;
}

textarea {
    resize: vertical;
    min-height: 100px;
}

input:focus,
textarea:focus {
    border-color: #4a90e2;
    outline: none;
    box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
}

.radio-group {
    display: flex;
    gap: 20px;
    margin-top: 5px;
}

.radio-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.radio-label input[type="radio"] {
    width: auto;
    margin: 0;
}

.form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #eee;
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s;
    gap: 8px;
}

.btn-primary {
    background-color: #4a90e2;
    color: white;
}

.btn-primary:hover {
    background-color: #3a7bc8;
}

.btn-danger {
    background-color: #e74c3c;
    color: white;
}

.btn-danger:hover {
    background-color: #c0392b;
}

.btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}
</style>
{% endblock %}
